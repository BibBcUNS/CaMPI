
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <title>Circulación</title>
    <link rel="stylesheet" type="text/css" href="/omp/circulacion/css/style.css" />
  </head>
  <body onload="window.document.form_abm.credencial.value=parent.indice.form_id.lector.value">
  <center>
    <div id="head"> 
		  <div id="title"><p align="left"><br>Módulo de Circulación - OPEN MarcoPolo</p>
		  <div id="logo"><img src="/omp/circulacion/images/logocampicir.gif"   width="120" height="54" ></div>
		  </div>
		 
      <div id="menu">
        <ul>
          <li>
            <a href="/index.html" target=_blank>
			Principal</a>
          </li>
		  <li>&nbsp;</li>
          <li  class="active">
            <a href="*" >Circulación</a>
          </li><li>&nbsp;</li>
          <li>
            <a href="/omp/administracion/login_form.php"  target=_blank>		
			Administración</a>
          </li><li>&nbsp;</li>
          <li>
            <a href="/omp/estadisticas/index.htm" target=_blank>Estadísticas</a>
          </li><li>&nbsp;</li>
		  <li>
             <a href="/catalis/catalogacion.htm" target=_blank>Catalogación</a>
          </li><li>&nbsp;</li>
		  <li>
            <a href= 
			"http://cabbib2.cnea.gov.ar/cgi-bin/opacmarc/wxis?IsisScript=opac/xis/opac.xis&db=celtic" 
			target=_blank>OPAC</a>
          </li><li>&nbsp;</li>
        </ul>
      </div>
    </div> 
    <div id="body_wrapper">
      <div id="body">
					 <div id="all">
					 			<div class="top"></div>
								<div class="content">
<form name="form_abm" method="POST" action="/cgi-bin/wxis.exe/omp/administracion/">
<input type="hidden" name="IsisScript" value="/omp/administracion/abmlector.xis">
<input type="hidden" name="opcion" value="Presentar">
<input type="hidden" name="credencial">
<input type="hidden" name="id_operador" value="id">
</form>
	<SCRIPT LANGUAGE="JavaScript">
	<!-- Begin

	 function presenta_observaciones () {
		 window.open("","Observaciones","width=500,height=300");
		 document.form_observaciones.submit();
	 }

	function renovar(Id) {
	document.getElementById("renovacion_"+Id).innerHTML="<p><font color=#660033><strong><small>Renovado</small></strong></font></p>";
	}


	function verificar() {
		
		// si se selecciona la fecha de vto. a través del almanaque carga este valor en el formulario control
		// modificando el valor del select
		// window.document.control.dias_vto_A Retorna un valor booleano (true|false). Es para comprobar
		// si se están utilizando fechas de vto manual o se calculan posteriormente de acuerdo a las políticas.

		if (window.document.control.dias_vto_A && window.document.control.dias_vto_A.value != "----") {
			window.document.control.dias_prestamo_A.options[window.document.control.dias_prestamo_A.selectedIndex].value = window.document.control.dias_vto_A.value;
		}
			
		if (window.document.control.dias_vto_B && window.document.control.dias_vto_B.value != "----") {
			window.document.control.dias_prestamo_B.options[window.document.control.dias_prestamo_B.selectedIndex].value = window.document.control.dias_vto_B.value;}

		window.document.verifica._enviar_invs.value = "";
		window.document.verifica._devoluciones_invs.value = "";

		for (j = 0; j < 100; j++) {
			element = "dev_" + j;	
			if (document.getElementById(element)) { 
				if (document.getElementById(element).status) {
					window.document.verifica._enviar.value = "1";
		  	        window.document.verifica._devoluciones_invs.value += window.document.getElementById(element).value + "\n"
		  	    }
				else {
					window.document.verifica._enviar_invs.value = document.getElementById(element).value + "\n"
				}
			}
		}

		if (window.document.control.invs_prestamo_A.value != "") {
			window.document.verifica.invs_prestamo_A.value = window.document.control.invs_prestamo_A.value
		}

		if (window.document.control.invs_prestamo_B && window.document.control.invs_prestamo_B.value != "") {
			window.document.verifica.invs_prestamo_B.value = window.document.control.invs_prestamo_B.value
		}

		if (window.document.control.invs_prestamo_A.value != "" || (window.document.control.invs_prestamo_B && window.document.control.invs_prestamo_B.value != "")) {
			window.open("/omp/circulacion//aguarde.html","VERIFICA","toolbar=0,location=0,directories=0,status=0,menubar=0,scrollbars=1,resizable=0,copyhistory=0,width=400,height=200");
			window.document.verifica.submit();
		}

		if (window.document.control.invs_prestamo_A.value == "" && (!window.document.control.invs_prestamo_B || window.document.control.invs_prestamo_B.value == "") && window.document.verifica._enviar.value == "1" && window.document.control.devolucion_1) {
			window.document.control.submit();
		}

		if (window.document.control.devolucion_1) { 
			if (window.document.control.invs_prestamo_A.value == "" && (!window.document.control.invs_prestamo_B || window.document.control.invs_prestamo_B.value == "") && window.document.verifica._enviar.value == "0") {
				alert ("No se puede enviar el formulario.\nPosibles errores:\n-- > No se ha marcado una devolución.\n-- > No se ha indicado un libro a prestar.");
			}
		}
		else {
			if (window.document.control.invs_prestamo_A.value == "" && (!window.document.control.invs_prestamo_B || window.document.control.invs_prestamo_B.value == "")) {
				alert ("No se puede enviar el formulario.\nError:\n-- > No se ha indicado un libro a prestar.");
			}
		}
	}

	function borrar() {
	window.document.verifica.invs_prestamo_A.value = "";
	window.document.verifica.invs_prestamo_B.value = "";
	}

	function cancelar() {
	window.document.control.operacion.value="CANCELA";
	if (confirm("Cancela la operación ?")) {
          window.document.control.submit()
          }
	}

	function iniciar() {
		var _Fecha = new Date();
		_Fecha.setFullYear(2008);
		_Fecha.setMonth(10);
		_Fecha.setDate(12);
		var j = 0;
		for (i = 0; i < 61; i++) {
	        var _QueDia = _Fecha.getDay();
		switch (_QueDia) {
			case 1 : _QueDia = "Lunes   "; break;
	 	 	case 2 : _QueDia = "Martes  "; break;
			case 3 : _QueDia = "Mierco. "; break; 
			case 4 : _QueDia = "Jueves  "; break;
			case 5 : _QueDia = "Viernes "; break;
			case 6 : _QueDia = "Sábado  ";
			}
		  if (_Fecha.getDate() < 10) {_Dia = "0" + _Fecha.getDate()} else {_Dia = _Fecha.getDate()};
		  if (_Fecha.getMonth() < 9) {_Mes = "0" + eval(_Fecha.getMonth()+1)} else {_Mes = eval(_Fecha.getMonth()+1)};
		  if (_Fecha.getDay() !="0" && (i < 11 || i == 15 || i == 20 || i == 30 || i == 45 || i == 50 || i == 55 || i == 60)) 
			{if (i == 0) {_Cant = "Hoy"} else {if (i == 1) {_Cant = i + " día"} else {_Cant = i + " días"}};
			 window.document.control.dias_prestamo_A.options[j] = new Option(_Cant + " -> " + _QueDia + _Dia + "/" + _Mes +  "/" + _Fecha.getYear());
			 window.document.control.dias_prestamo_A.options[j].value = _Dia + "/" + _Mes +  "/" + _Fecha.getYear();
			 j++};
		  _Fecha.setHours(_Fecha.getHours() + 24);
		}
		
		var _Fecha = new Date();
		_Fecha.setFullYear(2008);
		_Fecha.setMonth(10);
		_Fecha.setDate(12);
		var j = 0;
		for (i = 0; i < 61; i++) {
	        var _QueDia = _Fecha.getDay();
		switch (_QueDia) {
			case 1 : _QueDia = "Lunes   "; break;
	 	 	case 2 : _QueDia = "Martes  "; break;
			case 3 : _QueDia = "Mierco. "; break; 
			case 4 : _QueDia = "Jueves  "; break;
			case 5 : _QueDia = "Viernes "; break;
			case 6 : _QueDia = "Sábado  ";
			}
		  if (_Fecha.getDate() < 10) {_Dia = "0" + _Fecha.getDate()} else {_Dia = _Fecha.getDate()};
		  if (_Fecha.getMonth() < 9) {_Mes = "0" + eval(_Fecha.getMonth()+1)} else {_Mes = eval(_Fecha.getMonth()+1)};
		  if (_Fecha.getDay() !="0" && (i < 11 || i == 15 || i == 20 || i == 30 || i == 45 || i == 50 || i == 55 || i == 60)) 
			{if (i == 0) {_Cant = "Hoy"} else {if (i == 1) {_Cant = i + " día"} else {_Cant = i + " días"}};
			 window.document.control.dias_prestamo_B.options[j] = new Option(_Cant + " -> " + _QueDia + _Dia + "/" + _Mes +  "/" + _Fecha.getYear());
			 window.document.control.dias_prestamo_B.options[j].value = _Dia + "/" + _Mes +  "/" + _Fecha.getYear();
			 j++};
		  _Fecha.setHours(_Fecha.getHours() + 24);
		}
	window.document.verifica.enviar.value = "0";
	if (window.document.control.devolucion_1) {window.document.verifica._enviar.value = "0";}
		else {window.document.verifica._enviar.value = "1";}
	window.document.control.invs_prestamo_A.focus();
	}
	// End -->
	</script>

<table width="100%" border="0">

  <tr>

    <td width="24%"><img src="/omp/circulacion/fotos/30243359.jpg" width="128" height="96" align="middle"  OnError="this.src='/omp/circulacion/fotos/falta_foto.gif'"></td><td width="76%"><big>MARTINEZ, Manuel Osvaldo</big>, ARUNS<br><a href="JavaScript:presenta_observaciones()"><font face="Arial" size="3">Observaciones al Lector</font></a></td>

  </tr>

</table><h2><center><font color=red><a href="JavaScript:window.document.form_abm.credencial.value=parent.indice.form_id.lector.value; window.document.form_abm.submit()">Actualice los datos del usuario</a></font></center></h2><p><form name="control" method="POST" action="/cgi-bin/wxis.exe/omp/circulacion/" style="margin-bottom: 0">

  <input type="hidden" name="IsisScript" value="/omp/circulacion/prestamo.xis">

  <input type="hidden" name="opcion" value="WRITE">

  <input type="hidden" name="operacion" value="MODIFICA">

  <input type="hidden" name="Vto_AB">

  <input type="hidden" name="operador" value="id">

  <input type="hidden" name="mfn_lector" value="000001"><br><table border="0" width="90%">

       

        <th colspan="3" >Pr&eacute;stamos, indique los nros. de Inventario</th>

        <tr>

                <!-- prestamos A -->

                <td valign="middle" width="40%">

                        <p align="center"><strong>Inventarios<br>

                        </strong><textarea rows="5" name="invs_prestamo_A" cols="12"></textarea><br>

                        

                        

                        Días de Vigencia:<br>

                        <select name="dias_prestamo_A"

                                    size="1"

                                    onclick="window.document.control.dias_vto_A.value='----';">

                        </select><br>

                        

                        <DIV id=popCal_1 style="BORDER-RIGHT: 2px ridge; BORDER-TOP: 2px ridge; Z-INDEX: 100; VISIBILITY: hidden; BORDER-LEFT: 2px ridge;  BORDER-BOTTOM: 2px ridge; POSITION: absolute" onclick=event.cancelBubble=true>

                        <IFRAME name=popFrame_1

                                       src="\omp\circulacion\popcjs.htm"

                                       frameBorder=0

                                       width=183

                                       scrolling=no

                                       height=188>

                        </IFRAME></DIV>

                        

                        <SCRIPT event=onclick() for=document>popCal_1.style.visibility = "hidden";</SCRIPT>

                        

                        <center>

                        Calendario:

                        <INPUT style="TEXT-ALIGN: center" readOnly value="----" name="dias_vto_A" size="10">

                        <INPUT onclick="window.document.control.Vto_AB.value='A'; popFrame_1.fPopCalendar(dias_vto_A,dias_vto_A,popCal_1);return false;" type=button value=V>

                        </center>

                        

            	</td>

    

                <!-- prestamos B --><td valign="top" width="40%">

                        <p align="center"><strong>Inventarios<br>

                        </strong><textarea rows="5" name="invs_prestamo_B" cols="12"></textarea><br>

                        Días de Vigencia:<br>

                        <select name="dias_prestamo_B"

                                    size="1"

                                    onclick="window.document.control.dias_vto_B.value='----';">

                        </select><br>

                

                    	<DIV id=popCal_2 style="BORDER-RIGHT: 2px ridge; BORDER-TOP: 2px ridge; Z-INDEX: 100; VISIBILITY: hidden; BORDER-LEFT: 2px ridge;  BORDER-BOTTOM: 2px ridge; POSITION: absolute" onclick=event.cancelBubble=true>

                    	<IFRAME name=popFrame_2

                                       src="\omp\circulacion\popcjs.htm" 

                                       frameBorder=0

                                       width=183

                                       scrolling=no

                                       height=188>

                        </IFRAME></DIV>

                	

                    	<SCRIPT event=onclick() for=document>popCal_2.style.visibility = "hidden";</SCRIPT>

                    

                        <center>

                        Calendario:

                        <INPUT style="TEXT-ALIGN: center" readOnly value="----" name="dias_vto_B" size="10">

                        <INPUT onclick="window.document.control.Vto_AB.value='B'; popFrame_2.fPopCalendar(dias_vto_B,dias_vto_B,popCal_2); return false;" type=button value=V>

                        </center>

                </td>

                

                </td>

                        <td valign="top">

                        <p align="center">&nbsp;</p>

                        <p><input type="button" value="  Enviar      " onclick="verificar();return false;"></p>

                        <p><input type="reset"   value="  Limpiar    " onclick="borrar()"></p>

                        <p><input type="button" value="  Cancelar " onclick="cancelar();"></p>

                </td>

  </tr>

</table>



</form>

<br><table border="0" width="90%" cellspacing="10">

			<th colspan="2" >Reservas</th>

		<tr>

		<td colspan="2"> El usuario no registra Reservas</td>

		</tr>

		

		<td colspan="2"> El usuario no registra Esperas</td>

		</tr>

		

		<tr>

			<td>

				<form name="consultas" method="POST" action="/cgi-bin/wxis.exe/omp/circulacion/">

				<input type="hidden" name="IsisScript" value="omp/circulacion/consulta.xis">

				<input type="hidden" name="criterio" value="otro">

				<input type="hidden" name="usuario_id" value="30243359">

				<input type="hidden" name="operario_id" value="id">

	

				<table border="0" width="90%" cellpadding="0" cellspacing="0">

					<tr><th width="60%"><u>R</u>eservar material: </th>

					<td width="15%">&nbsp;&nbsp;<input type="text" name="expresion" size="15" accesskey="r">&nbsp;&nbsp;</td>

					<td align="right" width="10%"><input type="submit" value="Enviar">&nbsp;&nbsp;&nbsp;&nbsp;</td>

					<td width="5%"><a href="/omp/circulacion/marc_fst.txt" target="new">?</a></td>

					</tr>			

				</table>

				</form>

			</td>

		</tr>

		

	</table><form name="verifica" method="POST" action="/cgi-bin/wxis.exe/omp/circulacion/" target="VERIFICA">

  <input type="hidden" name="IsisScript" value="/omp/circulacion/control.xis">

  <input type="hidden" name="invs_prestamo_A">

  <input type="hidden" name="invs_prestamo_B">

  <input type="hidden" name="enviar">

  <input type="hidden" name="_enviar">

  <input type="hidden" name="_enviar_invs">

  <input type="hidden" name="_devoluciones_invs">

  <input type="hidden" name="documento" value="30243359">

</form>



<form name="form_observaciones" method="POST" action="/cgi-bin/wxis.exe/omp/circulacion/" target="Observaciones">  

	<input type="hidden" name="IsisScript" value="/omp/circulacion/observaciones_lector.xis">  

	<input type="hidden" name="opcion" value="PRESENTAR">  

	<input type="hidden" name="operador" value="id">  

	<input type="hidden" name="mfn_lector" value="000001">

</form>



<script>

    iniciar();

</script>

</font> 

	
 
								</div>
								<div class="bottom"></div>
						</div>
        <div class="clearer"></div>
      </div>
      <div class="clearer"></div>
    </div>
    <div id="end_body"></div>
		<div id="footer">Versión 0.1<br>(Julio 2008)</div></center>
  </body>
</html>
